CUDA_VISIBLE_DEVICES=1 python main.py --data_dir ../data/../data/cifar-10-inc --loss_fn cnn --finetune true --use_kfac False --log retrain
2019-10-16 02:54:09,288:INFO: Creating the datasets...
2019-10-16 02:54:09,343:INFO: - done.
2019-10-16 02:54:09,343:INFO: Creating the model...
2019-10-16 02:54:09,347:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-10-16 02:54:09,350:WARNING: From /home/xiaofengzhu/Documents/frosting_weights/src/model/modeling.py:224: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.batch_normalization instead.
2019-10-16 02:54:09,367:WARNING: From /home/xiaofengzhu/Documents/frosting_weights/src/model/modeling.py:233: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 02:54:09,425:WARNING: From /home/xiaofengzhu/Documents/frosting_weights/src/model/modeling.py:948: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

2019-10-16 02:54:09,478:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-16 02:54:09,645:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/ops/metrics_impl.py:363: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-16 02:54:09,715:INFO: - done.
2019-10-16 02:54:09,715:INFO: Starting training for at most 50 epoch(s) for the initial learner
2019-10-16 02:54:10,640:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-32
2019-10-16 02:54:10,668:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2019-10-16 02:54:10,669:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-32
2019-10-16 02:54:10,745:INFO: Learner 0, Epoch 33/82
2019-10-16 02:54:12,733:INFO: - Train metrics: accuracy: 0.4249 ; loss: 4.0888
2019-10-16 02:54:13,018:INFO: - Eval metrics: accuracy: 0.2469 ; loss: 3.1402
2019-10-16 02:54:13,278:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-32
2019-10-16 02:54:13,279:INFO: Learner 0, Epoch 34/82
2019-10-16 02:54:13,962:INFO: - Train metrics: accuracy: 0.6545 ; loss: 1.2562
2019-10-16 02:54:14,106:INFO: - Eval metrics: accuracy: 0.4016 ; loss: 2.2743
2019-10-16 02:54:14,145:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:966: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
2019-10-16 02:54:14,188:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-33
2019-10-16 02:54:14,188:INFO: Learner 0, Epoch 35/82
2019-10-16 02:54:14,889:INFO: - Train metrics: accuracy: 0.6353 ; loss: 1.1059
2019-10-16 02:54:15,031:INFO: - Eval metrics: accuracy: 0.3650 ; loss: 2.0481
2019-10-16 02:54:15,031:INFO: Learner 0, Epoch 36/82
2019-10-16 02:54:15,709:INFO: - Train metrics: accuracy: 0.7345 ; loss: 0.8301
2019-10-16 02:54:15,850:INFO: - Eval metrics: accuracy: 0.4260 ; loss: 2.1079
2019-10-16 02:54:15,929:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-35
2019-10-16 02:54:15,930:INFO: Learner 0, Epoch 37/82
2019-10-16 02:54:16,601:INFO: - Train metrics: accuracy: 0.7138 ; loss: 0.8149
2019-10-16 02:54:16,780:INFO: - Eval metrics: accuracy: 0.4535 ; loss: 1.6261
2019-10-16 02:54:16,861:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-36
2019-10-16 02:54:16,861:INFO: Learner 0, Epoch 38/82
2019-10-16 02:54:17,534:INFO: - Train metrics: accuracy: 0.7929 ; loss: 0.6437
2019-10-16 02:54:17,681:INFO: - Eval metrics: accuracy: 0.4426 ; loss: 1.9613
2019-10-16 02:54:17,682:INFO: Learner 0, Epoch 39/82
2019-10-16 02:54:18,360:INFO: - Train metrics: accuracy: 0.7711 ; loss: 0.6575
2019-10-16 02:54:18,705:INFO: - Eval metrics: accuracy: 0.5125 ; loss: 1.4441
2019-10-16 02:54:18,786:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-38
2019-10-16 02:54:18,786:INFO: Learner 0, Epoch 40/82
2019-10-16 02:54:19,463:INFO: - Train metrics: accuracy: 0.8357 ; loss: 0.5259
2019-10-16 02:54:19,791:INFO: - Eval metrics: accuracy: 0.4539 ; loss: 1.9189
2019-10-16 02:54:19,791:INFO: Learner 0, Epoch 41/82
2019-10-16 02:54:20,467:INFO: - Train metrics: accuracy: 0.8217 ; loss: 0.5296
2019-10-16 02:54:20,904:INFO: - Eval metrics: accuracy: 0.5322 ; loss: 1.4026
2019-10-16 02:54:20,986:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-40
2019-10-16 02:54:20,986:INFO: Learner 0, Epoch 42/82
2019-10-16 02:54:21,659:INFO: - Train metrics: accuracy: 0.8728 ; loss: 0.4375
2019-10-16 02:54:21,964:INFO: - Eval metrics: accuracy: 0.4609 ; loss: 1.8898
2019-10-16 02:54:21,964:INFO: Learner 0, Epoch 43/82
2019-10-16 02:54:22,641:INFO: - Train metrics: accuracy: 0.8569 ; loss: 0.4481
2019-10-16 02:54:23,021:INFO: - Eval metrics: accuracy: 0.5301 ; loss: 1.4614
2019-10-16 02:54:23,021:INFO: Learner 0, Epoch 44/82
2019-10-16 02:54:23,700:INFO: - Train metrics: accuracy: 0.8993 ; loss: 0.3733
2019-10-16 02:54:23,843:INFO: - Eval metrics: accuracy: 0.4664 ; loss: 1.8691
2019-10-16 02:54:23,843:INFO: Learner 0, Epoch 45/82
2019-10-16 02:54:24,519:INFO: - Train metrics: accuracy: 0.8887 ; loss: 0.3784
2019-10-16 02:54:24,667:INFO: - Eval metrics: accuracy: 0.5371 ; loss: 1.4269
2019-10-16 02:54:24,750:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-44
2019-10-16 02:54:24,750:INFO: Learner 0, Epoch 46/82
2019-10-16 02:54:25,424:INFO: - Train metrics: accuracy: 0.9209 ; loss: 0.3199
2019-10-16 02:54:25,569:INFO: - Eval metrics: accuracy: 0.4766 ; loss: 1.8701
2019-10-16 02:54:25,569:INFO: Learner 0, Epoch 47/82
2019-10-16 02:54:26,248:INFO: - Train metrics: accuracy: 0.9175 ; loss: 0.3163
2019-10-16 02:54:26,395:INFO: - Eval metrics: accuracy: 0.5355 ; loss: 1.4794
2019-10-16 02:54:26,395:INFO: Learner 0, Epoch 48/82
2019-10-16 02:54:27,071:INFO: - Train metrics: accuracy: 0.9399 ; loss: 0.2726
2019-10-16 02:54:27,216:INFO: - Eval metrics: accuracy: 0.4725 ; loss: 1.8930
2019-10-16 02:54:27,217:INFO: Learner 0, Epoch 49/82
2019-10-16 02:54:27,893:INFO: - Train metrics: accuracy: 0.9368 ; loss: 0.2722
2019-10-16 02:54:28,039:INFO: - Eval metrics: accuracy: 0.5516 ; loss: 1.4474
2019-10-16 02:54:28,121:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-48
2019-10-16 02:54:28,122:INFO: Learner 0, Epoch 50/82
2019-10-16 02:54:28,795:INFO: - Train metrics: accuracy: 0.9567 ; loss: 0.2317
2019-10-16 02:54:28,938:INFO: - Eval metrics: accuracy: 0.4797 ; loss: 1.8776
2019-10-16 02:54:28,938:INFO: Learner 0, Epoch 51/82
2019-10-16 02:54:29,614:INFO: - Train metrics: accuracy: 0.9552 ; loss: 0.2269
2019-10-16 02:54:29,759:INFO: - Eval metrics: accuracy: 0.5398 ; loss: 1.5189
2019-10-16 02:54:29,759:INFO: Learner 0, Epoch 52/82
2019-10-16 02:54:30,440:INFO: - Train metrics: accuracy: 0.9687 ; loss: 0.1999
2019-10-16 02:54:30,587:INFO: - Eval metrics: accuracy: 0.4764 ; loss: 1.9082
2019-10-16 02:54:30,587:INFO: Learner 0, Epoch 53/82
2019-10-16 02:54:31,265:INFO: - Train metrics: accuracy: 0.9682 ; loss: 0.1941
2019-10-16 02:54:31,415:INFO: - Eval metrics: accuracy: 0.5447 ; loss: 1.5305
2019-10-16 02:54:31,415:INFO: Learner 0, Epoch 54/82
2019-10-16 02:54:32,089:INFO: - Train metrics: accuracy: 0.9755 ; loss: 0.1767
2019-10-16 02:54:32,234:INFO: - Eval metrics: accuracy: 0.4973 ; loss: 1.8063
2019-10-16 02:54:32,235:INFO: Learner 0, Epoch 55/82
2019-10-16 02:54:32,916:INFO: - Train metrics: accuracy: 0.9759 ; loss: 0.1668
2019-10-16 02:54:33,062:INFO: - Eval metrics: accuracy: 0.5453 ; loss: 1.5840
2019-10-16 02:54:33,063:INFO: Learner 0, Epoch 56/82
2019-10-16 02:54:33,740:INFO: - Train metrics: accuracy: 0.9832 ; loss: 0.1517
2019-10-16 02:54:33,887:INFO: - Eval metrics: accuracy: 0.4975 ; loss: 1.8183
2019-10-16 02:54:33,887:INFO: Learner 0, Epoch 57/82
2019-10-16 02:54:34,562:INFO: - Train metrics: accuracy: 0.9828 ; loss: 0.1437
2019-10-16 02:54:34,707:INFO: - Eval metrics: accuracy: 0.5537 ; loss: 1.5328
2019-10-16 02:54:34,790:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-56
2019-10-16 02:54:34,790:INFO: Learner 0, Epoch 58/82
2019-10-16 02:54:35,469:INFO: - Train metrics: accuracy: 0.9880 ; loss: 0.1308
2019-10-16 02:54:35,615:INFO: - Eval metrics: accuracy: 0.4982 ; loss: 1.8454
2019-10-16 02:54:35,616:INFO: Learner 0, Epoch 59/82
2019-10-16 02:54:36,296:INFO: - Train metrics: accuracy: 0.9879 ; loss: 0.1245
2019-10-16 02:54:36,440:INFO: - Eval metrics: accuracy: 0.5498 ; loss: 1.6489
2019-10-16 02:54:36,441:INFO: Learner 0, Epoch 60/82
2019-10-16 02:54:37,117:INFO: - Train metrics: accuracy: 0.9907 ; loss: 0.1151
2019-10-16 02:54:37,263:INFO: - Eval metrics: accuracy: 0.5051 ; loss: 1.8373
2019-10-16 02:54:37,264:INFO: Learner 0, Epoch 61/82
2019-10-16 02:54:37,939:INFO: - Train metrics: accuracy: 0.9919 ; loss: 0.1075
2019-10-16 02:54:38,088:INFO: - Eval metrics: accuracy: 0.5564 ; loss: 1.6341
2019-10-16 02:54:38,174:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-60
2019-10-16 02:54:38,175:INFO: Learner 0, Epoch 62/82
2019-10-16 02:54:38,851:INFO: - Train metrics: accuracy: 0.9942 ; loss: 0.0981
2019-10-16 02:54:38,998:INFO: - Eval metrics: accuracy: 0.5076 ; loss: 1.8216
2019-10-16 02:54:38,999:INFO: Learner 0, Epoch 63/82
2019-10-16 02:54:39,678:INFO: - Train metrics: accuracy: 0.9942 ; loss: 0.0940
2019-10-16 02:54:39,825:INFO: - Eval metrics: accuracy: 0.5545 ; loss: 1.6829
2019-10-16 02:54:39,826:INFO: Learner 0, Epoch 64/82
2019-10-16 02:54:40,506:INFO: - Train metrics: accuracy: 0.9966 ; loss: 0.0848
2019-10-16 02:54:40,652:INFO: - Eval metrics: accuracy: 0.5203 ; loss: 1.7501
2019-10-16 02:54:40,652:INFO: Learner 0, Epoch 65/82
2019-10-16 02:54:41,330:INFO: - Train metrics: accuracy: 0.9956 ; loss: 0.0822
2019-10-16 02:54:41,478:INFO: - Eval metrics: accuracy: 0.5762 ; loss: 1.5913
2019-10-16 02:54:41,560:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-64
2019-10-16 02:54:41,561:INFO: Learner 0, Epoch 66/82
2019-10-16 02:54:42,237:INFO: - Train metrics: accuracy: 0.9982 ; loss: 0.0735
2019-10-16 02:54:42,384:INFO: - Eval metrics: accuracy: 0.5215 ; loss: 1.7942
2019-10-16 02:54:42,384:INFO: Learner 0, Epoch 67/82
2019-10-16 02:54:43,082:INFO: - Train metrics: accuracy: 0.9974 ; loss: 0.0715
2019-10-16 02:54:43,232:INFO: - Eval metrics: accuracy: 0.5684 ; loss: 1.6968
2019-10-16 02:54:43,232:INFO: Learner 0, Epoch 68/82
2019-10-16 02:54:43,912:INFO: - Train metrics: accuracy: 0.9984 ; loss: 0.0641
2019-10-16 02:54:44,059:INFO: - Eval metrics: accuracy: 0.5281 ; loss: 1.7355
2019-10-16 02:54:44,060:INFO: Learner 0, Epoch 69/82
2019-10-16 02:54:44,739:INFO: - Train metrics: accuracy: 0.9984 ; loss: 0.0620
2019-10-16 02:54:44,889:INFO: - Eval metrics: accuracy: 0.5801 ; loss: 1.6544
2019-10-16 02:54:44,969:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-68
2019-10-16 02:54:44,969:INFO: Learner 0, Epoch 70/82
2019-10-16 02:54:45,647:INFO: - Train metrics: accuracy: 0.9987 ; loss: 0.0571
2019-10-16 02:54:45,792:INFO: - Eval metrics: accuracy: 0.5318 ; loss: 1.7390
2019-10-16 02:54:45,792:INFO: Learner 0, Epoch 71/82
2019-10-16 02:54:46,474:INFO: - Train metrics: accuracy: 0.9987 ; loss: 0.0546
2019-10-16 02:54:46,625:INFO: - Eval metrics: accuracy: 0.5672 ; loss: 1.7206
2019-10-16 02:54:46,626:INFO: Learner 0, Epoch 72/82
2019-10-16 02:54:47,299:INFO: - Train metrics: accuracy: 0.9991 ; loss: 0.0494
2019-10-16 02:54:47,447:INFO: - Eval metrics: accuracy: 0.5473 ; loss: 1.6799
2019-10-16 02:54:47,448:INFO: Learner 0, Epoch 73/82
2019-10-16 02:54:48,133:INFO: - Train metrics: accuracy: 0.9991 ; loss: 0.0486
2019-10-16 02:54:48,279:INFO: - Eval metrics: accuracy: 0.5629 ; loss: 1.7719
2019-10-16 02:54:48,280:INFO: Learner 0, Epoch 74/82
2019-10-16 02:54:48,958:INFO: - Train metrics: accuracy: 0.9995 ; loss: 0.0416
2019-10-16 02:54:49,102:INFO: - Eval metrics: accuracy: 0.5506 ; loss: 1.6949
2019-10-16 02:54:49,102:INFO: Learner 0, Epoch 75/82
2019-10-16 02:54:49,782:INFO: - Train metrics: accuracy: 0.9996 ; loss: 0.0418
2019-10-16 02:54:49,930:INFO: - Eval metrics: accuracy: 0.5725 ; loss: 1.7387
2019-10-16 02:54:49,931:INFO: Learner 0, Epoch 76/82
2019-10-16 02:54:50,606:INFO: - Train metrics: accuracy: 0.9995 ; loss: 0.0367
2019-10-16 02:54:50,751:INFO: - Eval metrics: accuracy: 0.5639 ; loss: 1.6383
2019-10-16 02:54:50,752:INFO: Learner 0, Epoch 77/82
2019-10-16 02:54:51,432:INFO: - Train metrics: accuracy: 0.9997 ; loss: 0.0369
2019-10-16 02:54:51,577:INFO: - Eval metrics: accuracy: 0.5830 ; loss: 1.7267
2019-10-16 02:54:51,660:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-76
2019-10-16 02:54:51,661:INFO: Learner 0, Epoch 78/82
2019-10-16 02:54:52,344:INFO: - Train metrics: accuracy: 0.9999 ; loss: 0.0319
2019-10-16 02:54:52,489:INFO: - Eval metrics: accuracy: 0.5732 ; loss: 1.6361
2019-10-16 02:54:52,490:INFO: Learner 0, Epoch 79/82
2019-10-16 02:54:53,177:INFO: - Train metrics: accuracy: 0.9997 ; loss: 0.0332
2019-10-16 02:54:53,326:INFO: - Eval metrics: accuracy: 0.5662 ; loss: 1.8135
2019-10-16 02:54:53,327:INFO: Learner 0, Epoch 80/82
2019-10-16 02:54:54,005:INFO: - Train metrics: accuracy: 0.9998 ; loss: 0.0281
2019-10-16 02:54:54,151:INFO: - Eval metrics: accuracy: 0.5660 ; loss: 1.7097
2019-10-16 02:54:54,152:INFO: Learner 0, Epoch 81/82
2019-10-16 02:54:54,834:INFO: - Train metrics: accuracy: 0.9999 ; loss: 0.0275
2019-10-16 02:54:54,982:INFO: - Eval metrics: accuracy: 0.5984 ; loss: 1.6623
2019-10-16 02:54:55,065:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-80
2019-10-16 02:54:55,066:INFO: Learner 0, Epoch 82/82
2019-10-16 02:54:55,749:INFO: - Train metrics: accuracy: 0.9999 ; loss: 0.0245
2019-10-16 02:54:55,896:INFO: - Eval metrics: accuracy: 0.5715 ; loss: 1.7428
2019-10-16 02:54:55,910:INFO: global_epoch: 82 epoch(s) at learner 0
2019-10-16 02:54:55,911:INFO: total time: 46.19594049453735 seconds ---
