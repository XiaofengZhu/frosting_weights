CUDA_VISIBLE_DEVICES=1 python main.py --data_dir ../data/../data/mnist-inc --loss_fn retrain_regu_fisher --finetune true --use_kfac False --log fisher
2019-10-16 12:43:45,717:INFO: Creating the datasets...
2019-10-16 12:43:45,791:INFO: - done.
2019-10-16 12:43:45,791:INFO: Creating the model...
2019-10-16 12:43:45,796:WARNING: From /home/xzhu/.conda/envs/venv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-10-16 12:43:45,802:WARNING: From /data/gluster/brick1/xzhu/wcdl1/frosting_weights/src/model/modeling.py:426: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 12:43:45,835:WARNING: From /data/gluster/brick1/xzhu/wcdl1/frosting_weights/src/model/modeling.py:470: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

2019-10-16 12:43:46,826:WARNING: From /home/xzhu/.conda/envs/venv/lib/python3.6/site-packages/tensorflow/python/ops/metrics_impl.py:363: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-16 12:43:47,536:INFO: - done.
2019-10-16 12:43:47,536:INFO: Starting training for at most 50 epoch(s) for the initial learner
2019-10-16 12:43:49,208:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-36
2019-10-16 12:43:49,224:WARNING: From /home/xzhu/.conda/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2019-10-16 12:43:49,225:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-36
2019-10-16 12:43:49,341:INFO: Learner 0, Epoch 37/86
2019-10-16 12:43:53,031:INFO: - Train metrics: accuracy: 0.7200 ; loss: 1.7696
2019-10-16 12:43:53,877:INFO: - Eval metrics: accuracy: 0.8031 ; loss: 0.6682
2019-10-16 12:43:54,160:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-36
2019-10-16 12:43:54,161:INFO: Learner 0, Epoch 38/86
2019-10-16 12:43:55,314:INFO: - Train metrics: accuracy: 0.9303 ; loss: 0.2446
2019-10-16 12:43:55,597:INFO: - Eval metrics: accuracy: 0.9836 ; loss: 0.0454
2019-10-16 12:43:55,666:WARNING: From /home/xzhu/.conda/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:966: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
2019-10-16 12:43:55,819:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-37
2019-10-16 12:43:55,819:INFO: Learner 0, Epoch 39/86
2019-10-16 12:43:56,963:INFO: - Train metrics: accuracy: 0.9680 ; loss: 0.1020
2019-10-16 12:43:57,253:INFO: - Eval metrics: accuracy: 0.9730 ; loss: 0.0845
2019-10-16 12:43:57,254:INFO: Learner 0, Epoch 40/86
2019-10-16 12:43:58,398:INFO: - Train metrics: accuracy: 0.9782 ; loss: 0.0717
2019-10-16 12:43:58,648:INFO: - Eval metrics: accuracy: 0.9656 ; loss: 0.1055
2019-10-16 12:43:58,649:INFO: Learner 0, Epoch 41/86
2019-10-16 12:43:59,770:INFO: - Train metrics: accuracy: 0.9837 ; loss: 0.0547
2019-10-16 12:44:00,044:INFO: - Eval metrics: accuracy: 0.9852 ; loss: 0.0494
2019-10-16 12:44:00,407:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-40
2019-10-16 12:44:00,408:INFO: Learner 0, Epoch 42/86
2019-10-16 12:44:01,537:INFO: - Train metrics: accuracy: 0.9865 ; loss: 0.0449
2019-10-16 12:44:01,800:INFO: - Eval metrics: accuracy: 0.9414 ; loss: 0.1861
2019-10-16 12:44:01,801:INFO: Learner 0, Epoch 43/86
2019-10-16 12:44:02,965:INFO: - Train metrics: accuracy: 0.9880 ; loss: 0.0414
2019-10-16 12:44:03,231:INFO: - Eval metrics: accuracy: 0.9855 ; loss: 0.0533
2019-10-16 12:44:03,643:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-42
2019-10-16 12:44:03,644:INFO: Learner 0, Epoch 44/86
2019-10-16 12:44:04,769:INFO: - Train metrics: accuracy: 0.9895 ; loss: 0.0346
2019-10-16 12:44:05,066:INFO: - Eval metrics: accuracy: 0.9586 ; loss: 0.1477
2019-10-16 12:44:05,066:INFO: Learner 0, Epoch 45/86
2019-10-16 12:44:06,199:INFO: - Train metrics: accuracy: 0.9914 ; loss: 0.0312
2019-10-16 12:44:06,469:INFO: - Eval metrics: accuracy: 0.9711 ; loss: 0.0944
2019-10-16 12:44:06,469:INFO: Learner 0, Epoch 46/86
2019-10-16 12:44:07,616:INFO: - Train metrics: accuracy: 0.9927 ; loss: 0.0267
2019-10-16 12:44:07,965:INFO: - Eval metrics: accuracy: 0.9672 ; loss: 0.1126
2019-10-16 12:44:07,965:INFO: Learner 0, Epoch 47/86
2019-10-16 12:44:09,084:INFO: - Train metrics: accuracy: 0.9936 ; loss: 0.0234
2019-10-16 12:44:09,351:INFO: - Eval metrics: accuracy: 0.9695 ; loss: 0.1103
2019-10-16 12:44:09,352:INFO: Learner 0, Epoch 48/86
2019-10-16 12:44:10,506:INFO: - Train metrics: accuracy: 0.9945 ; loss: 0.0210
2019-10-16 12:44:10,772:INFO: - Eval metrics: accuracy: 0.9773 ; loss: 0.0757
2019-10-16 12:44:10,773:INFO: Learner 0, Epoch 49/86
2019-10-16 12:44:11,892:INFO: - Train metrics: accuracy: 0.9951 ; loss: 0.0190
2019-10-16 12:44:12,218:INFO: - Eval metrics: accuracy: 0.9719 ; loss: 0.0957
2019-10-16 12:44:12,219:INFO: Learner 0, Epoch 50/86
2019-10-16 12:44:13,355:INFO: - Train metrics: accuracy: 0.9967 ; loss: 0.0153
2019-10-16 12:44:13,618:INFO: - Eval metrics: accuracy: 0.9855 ; loss: 0.0542
2019-10-16 12:44:13,618:INFO: Learner 0, Epoch 51/86
2019-10-16 12:44:14,779:INFO: - Train metrics: accuracy: 0.9967 ; loss: 0.0145
2019-10-16 12:44:15,040:INFO: - Eval metrics: accuracy: 0.9770 ; loss: 0.0794
2019-10-16 12:44:15,040:INFO: Learner 0, Epoch 52/86
2019-10-16 12:44:16,165:INFO: - Train metrics: accuracy: 0.9979 ; loss: 0.0110
2019-10-16 12:44:16,426:INFO: - Eval metrics: accuracy: 0.9895 ; loss: 0.0420
2019-10-16 12:44:20,105:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-51
2019-10-16 12:44:20,106:INFO: Learner 0, Epoch 53/86
2019-10-16 12:44:21,304:INFO: - Train metrics: accuracy: 0.9976 ; loss: 0.0114
2019-10-16 12:44:21,821:INFO: - Eval metrics: accuracy: 0.9832 ; loss: 0.0600
2019-10-16 12:44:21,822:INFO: Learner 0, Epoch 54/86
2019-10-16 12:44:22,991:INFO: - Train metrics: accuracy: 0.9991 ; loss: 0.0076
2019-10-16 12:44:23,284:INFO: - Eval metrics: accuracy: 0.9945 ; loss: 0.0291
2019-10-16 12:44:23,558:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-53
2019-10-16 12:44:23,559:INFO: Learner 0, Epoch 55/86
2019-10-16 12:44:24,699:INFO: - Train metrics: accuracy: 0.9984 ; loss: 0.0092
2019-10-16 12:44:24,962:INFO: - Eval metrics: accuracy: 0.9875 ; loss: 0.0464
2019-10-16 12:44:24,963:INFO: Learner 0, Epoch 56/86
2019-10-16 12:44:26,106:INFO: - Train metrics: accuracy: 0.9994 ; loss: 0.0058
2019-10-16 12:44:26,577:INFO: - Eval metrics: accuracy: 0.9895 ; loss: 0.0307
2019-10-16 12:44:26,577:INFO: Learner 0, Epoch 57/86
2019-10-16 12:44:27,724:INFO: - Train metrics: accuracy: 0.9990 ; loss: 0.0072
2019-10-16 12:44:27,992:INFO: - Eval metrics: accuracy: 0.9887 ; loss: 0.0410
2019-10-16 12:44:27,993:INFO: Learner 0, Epoch 58/86
2019-10-16 12:44:29,138:INFO: - Train metrics: accuracy: 0.9998 ; loss: 0.0045
2019-10-16 12:44:29,399:INFO: - Eval metrics: accuracy: 0.9883 ; loss: 0.0401
2019-10-16 12:44:29,399:INFO: Learner 0, Epoch 59/86
2019-10-16 12:44:30,553:INFO: - Train metrics: accuracy: 0.9991 ; loss: 0.0061
2019-10-16 12:44:30,827:INFO: - Eval metrics: accuracy: 0.9863 ; loss: 0.0470
2019-10-16 12:44:30,828:INFO: Learner 0, Epoch 60/86
2019-10-16 12:44:31,959:INFO: - Train metrics: accuracy: 0.9998 ; loss: 0.0036
2019-10-16 12:44:32,218:INFO: - Eval metrics: accuracy: 0.9840 ; loss: 0.0601
2019-10-16 12:44:32,219:INFO: Learner 0, Epoch 61/86
2019-10-16 12:44:33,360:INFO: - Train metrics: accuracy: 0.9996 ; loss: 0.0044
2019-10-16 12:44:33,620:INFO: - Eval metrics: accuracy: 0.9859 ; loss: 0.0533
2019-10-16 12:44:33,621:INFO: Learner 0, Epoch 62/86
2019-10-16 12:44:34,749:INFO: - Train metrics: accuracy: 0.9999 ; loss: 0.0030
2019-10-16 12:44:35,017:INFO: - Eval metrics: accuracy: 0.9848 ; loss: 0.0606
2019-10-16 12:44:35,018:INFO: Learner 0, Epoch 63/86
2019-10-16 12:44:36,159:INFO: - Train metrics: accuracy: 0.9998 ; loss: 0.0033
2019-10-16 12:44:36,421:INFO: - Eval metrics: accuracy: 0.9844 ; loss: 0.0602
2019-10-16 12:44:36,422:INFO: Learner 0, Epoch 64/86
2019-10-16 12:44:37,574:INFO: - Train metrics: accuracy: 0.9999 ; loss: 0.0024
2019-10-16 12:44:37,833:INFO: - Eval metrics: accuracy: 0.9891 ; loss: 0.0532
2019-10-16 12:44:37,834:INFO: Early stopping at learner 0, epoch 65/86
2019-10-16 12:44:37,849:INFO: global_epoch: 64 epoch(s) at learner 0
2019-10-16 12:44:37,850:INFO: total time: 50.31324553489685 seconds ---
