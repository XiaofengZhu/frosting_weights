CUDA_VISIBLE_DEVICES=1 python main.py --data_dir ../data/../data/cifar-10-inc --loss_fn retrain_regu_fisher --finetune true --use_kfac False --log fisher
2019-10-16 11:11:38,790:INFO: Creating the datasets...
2019-10-16 11:11:38,844:INFO: - done.
2019-10-16 11:11:38,844:INFO: Creating the model...
2019-10-16 11:11:38,847:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-10-16 11:11:38,851:WARNING: From /home/xiaofengzhu/Documents/frosting_weights/src/model/modeling.py:426: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 11:11:38,876:WARNING: From /home/xiaofengzhu/Documents/frosting_weights/src/model/modeling.py:470: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

2019-10-16 11:11:39,554:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/ops/metrics_impl.py:363: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-16 11:11:40,107:INFO: - done.
2019-10-16 11:11:40,107:INFO: Starting training for at most 50 epoch(s) for the initial learner
2019-10-16 11:11:41,286:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-32
2019-10-16 11:11:41,298:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2019-10-16 11:11:41,298:INFO: Restoring parameters from experiments/base_model/best_weights/after-epoch-32
2019-10-16 11:11:41,379:INFO: Learner 0, Epoch 33/82
2019-10-16 11:11:44,776:INFO: - Train metrics: accuracy: 0.2839 ; loss: 4.9479
2019-10-16 11:11:45,285:INFO: - Eval metrics: accuracy: 0.0836 ; loss: 3.2840
2019-10-16 11:11:45,732:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-32
2019-10-16 11:11:45,732:INFO: Learner 0, Epoch 34/82
2019-10-16 11:11:46,786:INFO: - Train metrics: accuracy: 0.3646 ; loss: 2.5085
2019-10-16 11:11:47,118:INFO: - Eval metrics: accuracy: 0.0711 ; loss: 3.6829
2019-10-16 11:11:47,119:INFO: Learner 0, Epoch 35/82
2019-10-16 11:11:48,162:INFO: - Train metrics: accuracy: 0.4589 ; loss: 2.2270
2019-10-16 11:11:48,529:INFO: - Eval metrics: accuracy: 0.1164 ; loss: 2.8773
2019-10-16 11:11:48,578:WARNING: From /home/xiaofengzhu/anaconda3/envs/venv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:966: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
2019-10-16 11:11:48,683:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-34
2019-10-16 11:11:48,683:INFO: Learner 0, Epoch 36/82
2019-10-16 11:11:49,740:INFO: - Train metrics: accuracy: 0.4442 ; loss: 1.8878
2019-10-16 11:11:50,072:INFO: - Eval metrics: accuracy: 0.0826 ; loss: 3.6138
2019-10-16 11:11:50,072:INFO: Learner 0, Epoch 37/82
2019-10-16 11:11:51,120:INFO: - Train metrics: accuracy: 0.5342 ; loss: 1.8341
2019-10-16 11:11:51,441:INFO: - Eval metrics: accuracy: 0.1867 ; loss: 2.4482
2019-10-16 11:11:51,596:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-36
2019-10-16 11:11:51,597:INFO: Learner 0, Epoch 38/82
2019-10-16 11:11:52,645:INFO: - Train metrics: accuracy: 0.4972 ; loss: 1.6059
2019-10-16 11:11:52,988:INFO: - Eval metrics: accuracy: 0.2043 ; loss: 2.6571
2019-10-16 11:11:53,141:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-37
2019-10-16 11:11:53,141:INFO: Learner 0, Epoch 39/82
2019-10-16 11:11:54,185:INFO: - Train metrics: accuracy: 0.5654 ; loss: 1.6581
2019-10-16 11:11:54,716:INFO: - Eval metrics: accuracy: 0.2561 ; loss: 2.2274
2019-10-16 11:11:54,862:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-38
2019-10-16 11:11:54,869:INFO: Learner 0, Epoch 40/82
2019-10-16 11:11:55,922:INFO: - Train metrics: accuracy: 0.5566 ; loss: 1.3869
2019-10-16 11:11:56,463:INFO: - Eval metrics: accuracy: 0.2074 ; loss: 2.7809
2019-10-16 11:11:56,464:INFO: Learner 0, Epoch 41/82
2019-10-16 11:11:57,507:INFO: - Train metrics: accuracy: 0.5927 ; loss: 1.4756
2019-10-16 11:11:58,047:INFO: - Eval metrics: accuracy: 0.2764 ; loss: 2.3290
2019-10-16 11:11:58,200:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-40
2019-10-16 11:11:58,200:INFO: Learner 0, Epoch 42/82
2019-10-16 11:11:59,257:INFO: - Train metrics: accuracy: 0.5552 ; loss: 1.3782
2019-10-16 11:11:59,848:INFO: - Eval metrics: accuracy: 0.2244 ; loss: 2.5806
2019-10-16 11:11:59,849:INFO: Learner 0, Epoch 43/82
2019-10-16 11:12:00,896:INFO: - Train metrics: accuracy: 0.5980 ; loss: 1.3964
2019-10-16 11:12:01,419:INFO: - Eval metrics: accuracy: 0.2639 ; loss: 2.4578
2019-10-16 11:12:01,419:INFO: Learner 0, Epoch 44/82
2019-10-16 11:12:02,472:INFO: - Train metrics: accuracy: 0.5898 ; loss: 1.2606
2019-10-16 11:12:02,801:INFO: - Eval metrics: accuracy: 0.2275 ; loss: 2.6549
2019-10-16 11:12:02,801:INFO: Learner 0, Epoch 45/82
2019-10-16 11:12:03,839:INFO: - Train metrics: accuracy: 0.6202 ; loss: 1.2833
2019-10-16 11:12:04,173:INFO: - Eval metrics: accuracy: 0.3113 ; loss: 2.1495
2019-10-16 11:12:04,329:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-44
2019-10-16 11:12:04,330:INFO: Learner 0, Epoch 46/82
2019-10-16 11:12:05,389:INFO: - Train metrics: accuracy: 0.6318 ; loss: 1.1157
2019-10-16 11:12:05,724:INFO: - Eval metrics: accuracy: 0.2656 ; loss: 2.4668
2019-10-16 11:12:05,725:INFO: Learner 0, Epoch 47/82
2019-10-16 11:12:06,779:INFO: - Train metrics: accuracy: 0.6481 ; loss: 1.1834
2019-10-16 11:12:07,118:INFO: - Eval metrics: accuracy: 0.3039 ; loss: 2.2865
2019-10-16 11:12:07,118:INFO: Learner 0, Epoch 48/82
2019-10-16 11:12:08,176:INFO: - Train metrics: accuracy: 0.6554 ; loss: 1.0603
2019-10-16 11:12:08,505:INFO: - Eval metrics: accuracy: 0.2664 ; loss: 2.4976
2019-10-16 11:12:08,506:INFO: Learner 0, Epoch 49/82
2019-10-16 11:12:09,554:INFO: - Train metrics: accuracy: 0.6705 ; loss: 1.0740
2019-10-16 11:12:09,885:INFO: - Eval metrics: accuracy: 0.3367 ; loss: 2.1390
2019-10-16 11:12:10,037:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-48
2019-10-16 11:12:10,037:INFO: Learner 0, Epoch 50/82
2019-10-16 11:12:11,079:INFO: - Train metrics: accuracy: 0.6801 ; loss: 0.9688
2019-10-16 11:12:11,408:INFO: - Eval metrics: accuracy: 0.3109 ; loss: 2.3013
2019-10-16 11:12:11,409:INFO: Learner 0, Epoch 51/82
2019-10-16 11:12:12,449:INFO: - Train metrics: accuracy: 0.6848 ; loss: 1.0197
2019-10-16 11:12:12,782:INFO: - Eval metrics: accuracy: 0.3590 ; loss: 2.0766
2019-10-16 11:12:12,934:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-50
2019-10-16 11:12:12,934:INFO: Learner 0, Epoch 52/82
2019-10-16 11:12:13,982:INFO: - Train metrics: accuracy: 0.7006 ; loss: 0.9213
2019-10-16 11:12:14,313:INFO: - Eval metrics: accuracy: 0.3223 ; loss: 2.3575
2019-10-16 11:12:14,313:INFO: Learner 0, Epoch 53/82
2019-10-16 11:12:15,349:INFO: - Train metrics: accuracy: 0.6969 ; loss: 0.9738
2019-10-16 11:12:15,685:INFO: - Eval metrics: accuracy: 0.4160 ; loss: 1.8090
2019-10-16 11:12:15,834:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-52
2019-10-16 11:12:15,834:INFO: Learner 0, Epoch 54/82
2019-10-16 11:12:16,884:INFO: - Train metrics: accuracy: 0.7151 ; loss: 0.8750
2019-10-16 11:12:17,218:INFO: - Eval metrics: accuracy: 0.3803 ; loss: 2.0812
2019-10-16 11:12:17,219:INFO: Learner 0, Epoch 55/82
2019-10-16 11:12:18,272:INFO: - Train metrics: accuracy: 0.7171 ; loss: 0.8913
2019-10-16 11:12:18,608:INFO: - Eval metrics: accuracy: 0.4193 ; loss: 1.8405
2019-10-16 11:12:18,755:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-54
2019-10-16 11:12:18,761:INFO: Learner 0, Epoch 56/82
2019-10-16 11:12:19,807:INFO: - Train metrics: accuracy: 0.7406 ; loss: 0.8066
2019-10-16 11:12:20,141:INFO: - Eval metrics: accuracy: 0.3936 ; loss: 2.0931
2019-10-16 11:12:20,141:INFO: Learner 0, Epoch 57/82
2019-10-16 11:12:21,189:INFO: - Train metrics: accuracy: 0.7313 ; loss: 0.8411
2019-10-16 11:12:21,519:INFO: - Eval metrics: accuracy: 0.4316 ; loss: 1.8318
2019-10-16 11:12:21,669:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-56
2019-10-16 11:12:21,670:INFO: Learner 0, Epoch 58/82
2019-10-16 11:12:22,728:INFO: - Train metrics: accuracy: 0.7592 ; loss: 0.7715
2019-10-16 11:12:23,061:INFO: - Eval metrics: accuracy: 0.4363 ; loss: 1.8977
2019-10-16 11:12:23,216:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-57
2019-10-16 11:12:23,216:INFO: Learner 0, Epoch 59/82
2019-10-16 11:12:24,268:INFO: - Train metrics: accuracy: 0.7474 ; loss: 0.7870
2019-10-16 11:12:24,605:INFO: - Eval metrics: accuracy: 0.4508 ; loss: 1.7735
2019-10-16 11:12:24,755:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-58
2019-10-16 11:12:24,755:INFO: Learner 0, Epoch 60/82
2019-10-16 11:12:25,802:INFO: - Train metrics: accuracy: 0.7772 ; loss: 0.7186
2019-10-16 11:12:26,133:INFO: - Eval metrics: accuracy: 0.4527 ; loss: 1.8622
2019-10-16 11:12:26,286:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-59
2019-10-16 11:12:26,287:INFO: Learner 0, Epoch 61/82
2019-10-16 11:12:27,328:INFO: - Train metrics: accuracy: 0.7665 ; loss: 0.7351
2019-10-16 11:12:27,665:INFO: - Eval metrics: accuracy: 0.4494 ; loss: 1.8002
2019-10-16 11:12:27,665:INFO: Learner 0, Epoch 62/82
2019-10-16 11:12:28,703:INFO: - Train metrics: accuracy: 0.7872 ; loss: 0.6852
2019-10-16 11:12:29,033:INFO: - Eval metrics: accuracy: 0.4869 ; loss: 1.7317
2019-10-16 11:12:29,183:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-61
2019-10-16 11:12:29,184:INFO: Learner 0, Epoch 63/82
2019-10-16 11:12:30,234:INFO: - Train metrics: accuracy: 0.7828 ; loss: 0.6908
2019-10-16 11:12:30,572:INFO: - Eval metrics: accuracy: 0.4680 ; loss: 1.7656
2019-10-16 11:12:30,572:INFO: Learner 0, Epoch 64/82
2019-10-16 11:12:31,607:INFO: - Train metrics: accuracy: 0.8007 ; loss: 0.6381
2019-10-16 11:12:31,936:INFO: - Eval metrics: accuracy: 0.4643 ; loss: 1.8704
2019-10-16 11:12:31,967:INFO: Learner 0, Epoch 65/82
2019-10-16 11:12:33,036:INFO: - Train metrics: accuracy: 0.7734 ; loss: 0.6996
2019-10-16 11:12:33,382:INFO: - Eval metrics: accuracy: 0.4828 ; loss: 1.7140
2019-10-16 11:12:33,382:INFO: Learner 0, Epoch 66/82
2019-10-16 11:12:34,433:INFO: - Train metrics: accuracy: 0.8100 ; loss: 0.6158
2019-10-16 11:12:34,762:INFO: - Eval metrics: accuracy: 0.4941 ; loss: 1.7303
2019-10-16 11:12:34,913:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-65
2019-10-16 11:12:34,913:INFO: Learner 0, Epoch 67/82
2019-10-16 11:12:35,976:INFO: - Train metrics: accuracy: 0.7820 ; loss: 0.6834
2019-10-16 11:12:36,316:INFO: - Eval metrics: accuracy: 0.5148 ; loss: 1.5865
2019-10-16 11:12:36,468:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-66
2019-10-16 11:12:36,469:INFO: Learner 0, Epoch 68/82
2019-10-16 11:12:37,505:INFO: - Train metrics: accuracy: 0.8144 ; loss: 0.5960
2019-10-16 11:12:37,941:INFO: - Eval metrics: accuracy: 0.4963 ; loss: 1.7940
2019-10-16 11:12:37,942:INFO: Learner 0, Epoch 69/82
2019-10-16 11:12:38,992:INFO: - Train metrics: accuracy: 0.7777 ; loss: 0.7104
2019-10-16 11:12:39,331:INFO: - Eval metrics: accuracy: 0.4984 ; loss: 1.7023
2019-10-16 11:12:39,332:INFO: Learner 0, Epoch 70/82
2019-10-16 11:12:40,390:INFO: - Train metrics: accuracy: 0.8117 ; loss: 0.5873
2019-10-16 11:12:40,726:INFO: - Eval metrics: accuracy: 0.4953 ; loss: 1.8784
2019-10-16 11:12:40,726:INFO: Learner 0, Epoch 71/82
2019-10-16 11:12:41,785:INFO: - Train metrics: accuracy: 0.7757 ; loss: 0.7038
2019-10-16 11:12:42,130:INFO: - Eval metrics: accuracy: 0.5375 ; loss: 1.5332
2019-10-16 11:12:42,283:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-70
2019-10-16 11:12:42,283:INFO: Learner 0, Epoch 72/82
2019-10-16 11:12:43,342:INFO: - Train metrics: accuracy: 0.8481 ; loss: 0.5007
2019-10-16 11:12:43,679:INFO: - Eval metrics: accuracy: 0.5154 ; loss: 1.8218
2019-10-16 11:12:43,679:INFO: Learner 0, Epoch 73/82
2019-10-16 11:12:44,734:INFO: - Train metrics: accuracy: 0.8039 ; loss: 0.6259
2019-10-16 11:12:45,065:INFO: - Eval metrics: accuracy: 0.5764 ; loss: 1.3613
2019-10-16 11:12:45,216:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-72
2019-10-16 11:12:45,216:INFO: Learner 0, Epoch 74/82
2019-10-16 11:12:46,275:INFO: - Train metrics: accuracy: 0.8708 ; loss: 0.4405
2019-10-16 11:12:46,617:INFO: - Eval metrics: accuracy: 0.5373 ; loss: 1.7166
2019-10-16 11:12:46,618:INFO: Learner 0, Epoch 75/82
2019-10-16 11:12:47,666:INFO: - Train metrics: accuracy: 0.8224 ; loss: 0.5690
2019-10-16 11:12:48,002:INFO: - Eval metrics: accuracy: 0.5986 ; loss: 1.2760
2019-10-16 11:12:48,153:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-74
2019-10-16 11:12:48,154:INFO: Learner 0, Epoch 76/82
2019-10-16 11:12:49,195:INFO: - Train metrics: accuracy: 0.8881 ; loss: 0.3904
2019-10-16 11:12:49,533:INFO: - Eval metrics: accuracy: 0.5660 ; loss: 1.6366
2019-10-16 11:12:49,533:INFO: Learner 0, Epoch 77/82
2019-10-16 11:12:50,580:INFO: - Train metrics: accuracy: 0.8396 ; loss: 0.5158
2019-10-16 11:12:50,916:INFO: - Eval metrics: accuracy: 0.6184 ; loss: 1.2405
2019-10-16 11:12:51,069:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-76
2019-10-16 11:12:51,069:INFO: Learner 0, Epoch 78/82
2019-10-16 11:12:52,115:INFO: - Train metrics: accuracy: 0.9043 ; loss: 0.3463
2019-10-16 11:12:52,449:INFO: - Eval metrics: accuracy: 0.5854 ; loss: 1.5623
2019-10-16 11:12:52,450:INFO: Learner 0, Epoch 79/82
2019-10-16 11:12:53,519:INFO: - Train metrics: accuracy: 0.8570 ; loss: 0.4652
2019-10-16 11:12:53,862:INFO: - Eval metrics: accuracy: 0.6285 ; loss: 1.1935
2019-10-16 11:12:54,007:INFO: - Found new best metric score, saving in experiments/base_model/best_weights/after-epoch-78
2019-10-16 11:12:54,014:INFO: Learner 0, Epoch 80/82
2019-10-16 11:12:55,054:INFO: - Train metrics: accuracy: 0.9154 ; loss: 0.3161
2019-10-16 11:12:55,389:INFO: - Eval metrics: accuracy: 0.6080 ; loss: 1.4652
2019-10-16 11:12:55,390:INFO: Learner 0, Epoch 81/82
2019-10-16 11:12:56,445:INFO: - Train metrics: accuracy: 0.8783 ; loss: 0.4128
2019-10-16 11:12:56,782:INFO: - Eval metrics: accuracy: 0.6260 ; loss: 1.2188
2019-10-16 11:12:56,782:INFO: Learner 0, Epoch 82/82
2019-10-16 11:12:57,827:INFO: - Train metrics: accuracy: 0.9295 ; loss: 0.2747
2019-10-16 11:12:58,157:INFO: - Eval metrics: accuracy: 0.6221 ; loss: 1.4372
2019-10-16 11:12:58,170:INFO: global_epoch: 82 epoch(s) at learner 0
2019-10-16 11:12:58,171:INFO: total time: 78.06323504447937 seconds ---
